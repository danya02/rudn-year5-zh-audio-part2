import{Q as P}from"./QBtn-CIsvksZH.js";import{b as K,u as G,a as J,i as X,Q as W,d as Y,e as Z,f as ee,g as te,h as A}from"./QLayout-BBLPXPjK.js";import{d as le,e as oe,f as ae,h as ne,Q as ue}from"./dom-BLl5AtAN.js";import{a as v,d as r,q as _,g as re,N as I,s as M,x as se,D as ie,O as ce,b as de,h as fe,c as B,E as V,o as g,F as p,G as N,M as j,P as D,I as x,H as Q,J as ve,K as me,L as ge,Q as pe}from"./index-sT4AzHdS.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ke(n,d){const e=v(null),f=r(()=>n.disable===!0?null:_("span",{ref:e,class:"no-outline",tabindex:-1}));function i(u){const c=d.value;u?.qAvoidFocus!==!0&&(u?.type.indexOf("key")===0?document.activeElement!==c&&c?.contains(document.activeElement)===!0&&c.focus():e.value!==null&&(u===void 0||c?.contains(u.target)===!0)&&e.value.focus())}return{refocusTargetEl:f,refocusTarget:i}}const ye={xs:30,sm:35,md:40,lg:50,xl:60},he={...G,...le,...K,modelValue:{required:!0,default:null},val:{},trueValue:{default:!0},falseValue:{default:!1},indeterminateValue:{default:null},checkedIcon:String,uncheckedIcon:String,indeterminateIcon:String,toggleOrder:{type:String,validator:n=>n==="tf"||n==="ft"},toggleIndeterminate:Boolean,label:String,leftLabel:Boolean,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},_e=["update:modelValue"];function Ce(n,d){const{props:e,slots:f,emit:i,proxy:u}=re(),{$q:c}=u,S=J(e,c),m=v(null),{refocusTargetEl:C,refocusTarget:q}=ke(e,m),$=oe(e,ye),b=r(()=>e.val!==void 0&&Array.isArray(e.modelValue)),T=r(()=>{const t=I(e.val);return b.value===!0?e.modelValue.findIndex(h=>I(h)===t):-1}),s=r(()=>b.value===!0?T.value!==-1:I(e.modelValue)===I(e.trueValue)),w=r(()=>b.value===!0?T.value===-1:I(e.modelValue)===I(e.falseValue)),k=r(()=>s.value===!1&&w.value===!1),L=r(()=>e.disable===!0?-1:e.tabindex||0),E=r(()=>`q-${n} cursor-pointer no-outline row inline no-wrap items-center`+(e.disable===!0?" disabled":"")+(S.value===!0?` q-${n}--dark`:"")+(e.dense===!0?` q-${n}--dense`:"")+(e.leftLabel===!0?" reverse":"")),F=r(()=>{const t=s.value===!0?"truthy":w.value===!0?"falsy":"indet",h=e.color!==void 0&&(e.keepColor===!0||s.value===!0)?` text-${e.color}`:"";return`q-${n}__inner relative-position non-selectable q-${n}__inner--${t}${h}`}),a=r(()=>{const t={type:"checkbox"};return e.name!==void 0&&Object.assign(t,{".checked":s.value,"^checked":s.value===!0?"checked":void 0,name:e.name,value:b.value===!0?e.val:e.trueValue}),t}),l=X(a),o=r(()=>{const t={tabindex:L.value,role:"switch","aria-label":e.label,"aria-checked":k.value===!0?"mixed":s.value===!0?"true":"false"};return e.disable===!0&&(t["aria-disabled"]="true"),t});function y(t){t!==void 0&&(M(t),q(t)),e.disable!==!0&&i("update:modelValue",O(),t)}function O(){if(b.value===!0){if(s.value===!0){const t=e.modelValue.slice();return t.splice(T.value,1),t}return e.modelValue.concat([e.val])}if(s.value===!0){if(e.toggleOrder!=="ft"||e.toggleIndeterminate===!1)return e.falseValue}else if(w.value===!0){if(e.toggleOrder==="ft"||e.toggleIndeterminate===!1)return e.trueValue}else return e.toggleOrder!=="ft"?e.trueValue:e.falseValue;return e.indeterminateValue}function R(t){(t.keyCode===13||t.keyCode===32)&&M(t)}function U(t){(t.keyCode===13||t.keyCode===32)&&y(t)}const H=d(s,k);return Object.assign(u,{toggle:y}),()=>{const t=H();e.disable!==!0&&l(t,"unshift",` q-${n}__native absolute q-ma-none q-pa-none`);const h=[_("div",{class:F.value,style:$.value,"aria-hidden":"true"},t)];C.value!==null&&h.push(C.value);const z=e.label!==void 0?ae(f.default,[e.label]):ne(f.default);return z!==void 0&&h.push(_("div",{class:`q-${n}__label q-anchor--skip`},z)),_("div",{ref:m,class:E.value,...o.value,onClick:y,onKeydown:R,onKeyup:U},h)}}const Ie=se({name:"QToggle",props:{...he,icon:String,iconColor:String},emits:_e,setup(n){function d(e,f){const i=r(()=>(e.value===!0?n.checkedIcon:f.value===!0?n.indeterminateIcon:n.uncheckedIcon)||n.icon),u=r(()=>e.value===!0?n.iconColor:null);return()=>[_("div",{class:"q-toggle__track"}),_("div",{class:"q-toggle__thumb absolute flex flex-center no-wrap"},i.value!==void 0?[_(ue,{name:i.value,color:u.value})]:void 0)]}return Ce("toggle",d)}}),Ve=["src"],xe={key:2},Se={key:3},qe={key:4,class:"q-gutter-sm"},$e={class:"q-btn__progress absolute-full overflow-hidden"},Te=ie({__name:"ItemPage",props:{mediaId:{}},setup(n){const d=n,e=ce("audio"),f=v(!1),i=v(null),u=v(0),c=v(!1),S=v(!0),m=v(null),C=d.mediaId,q=[["canplaythrough",L],["progress",b],["buffered",T],["timeupdate",s]],$=v(null);function b(a){console.log("progress",a),k()}function T(a){console.log("buffered",a),k()}function s(a){console.log("timeupdate",a),k()}de(async function(){console.log("onMounted",d,d.mediaId),console.log("onMounted",e.value,q);for(const l of q){console.log("onMounted",l);const[o,y]=l;e.value?.addEventListener(o,y)}$.value=setInterval(k,100);const a=await(await fetch(C+".manifest.json")).json();i.value=a}),fe(function(){console.log("onBeforeUnmount");for(const a of q){const[l,o]=a;console.log("onBeforeUnmount",l),e.value?.removeEventListener(l,o)}$.value!==null&&clearInterval($.value)});function w(a){e.value!==null&&(e.value.currentTime=a.start/1e3,e.value.play(),m.value=a)}function k(){u.value=(e.value?.currentTime??0)*1e3||0,console.log("playback position millis",u.value,m.value),S.value=e.value?.paused??!0,m.value!==null&&u.value>m.value.end&&(c.value&&(console.log("pausing"),e.value?.pause(),S.value=!0),m.value=null)}function L(){f.value=!0}function E(a,l,o){return o<a?"grey":o>l?"primary":"accent"}function F(a,l,o){return o<a||o>l?"":`transform: translateX(-${100-(o-a)/(l-a)*100}%)`}return(a,l)=>(g(),B(W,{view:"lHh Lpr lFf"},{default:V(()=>[p(Y,{elevated:""},{default:V(()=>[p(Z,null,{default:V(()=>[p(P,{flat:"",dense:"",round:"",icon:"arrow_back",onClick:l[0]||(l[0]=o=>a.$router.go(-1))}),p(ee,null,{default:V(()=>[N(j(D(C)),1)]),_:1})]),_:1})]),_:1}),p(te,null,{default:V(()=>[x("audio",{controls:"",preload:"auto",ref_key:"audio",ref:e,style:{width:"100%"}},[x("source",{src:`${D(C)}`},null,8,Ve)],512),S.value?(g(),B(P,{key:0,onClick:l[1]||(l[1]=o=>e.value?.play()),label:"Play",color:"primary",style:{width:"100%"}})):(g(),B(P,{key:1,onClick:l[2]||(l[2]=o=>e.value?.pause()),label:"Pause",color:"secondary",style:{width:"100%"}})),p(Ie,{modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=o=>c.value=o),label:"Pause after playing segment"},null,8,["modelValue"]),f.value?ve("",!0):(g(),Q("div",xe,[p(A,{color:"primary",size:"3em"}),l[4]||(l[4]=x("p",null,"Loading audio...",-1))])),i.value===null?(g(),Q("div",Se,[p(A,{color:"primary",size:"3em"}),l[5]||(l[5]=x("p",null,"Loading manifest...",-1))])):(g(),Q("div",qe,[(g(!0),Q(me,null,ge(i.value.segments,o=>(g(),B(P,{key:o.start,color:E(o.start,o.end,u.value),percentage:10,"data-status":10,onClick:y=>w(o)},{default:V(()=>[N(j(o.text)+" ",1),x("span",$e,[x("span",{class:"q-btn__progress-indicator fit block",style:pe(F(o.start,o.end,u.value))},null,4)])]),_:2},1032,["color","onClick"]))),128))]))]),_:1})]),_:1}))}}),Ee=be(Te,[["__scopeId","data-v-2c400c37"]]);export{Ee as default};
